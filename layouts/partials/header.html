{{/* layouts/partials/header.html */}}
{{ $app := . }}
{{ $isHome := eq .Kind "home" }}
{{ $nav := or $app.Params.nav .Site.Data.config.site.nav }}
{{ $scratch := newScratch }}
{{ if not $isHome }}
    {{ if $app.Params.logo }}
        {{ $scratch.Set "logoInitials" $app.Params.logo.initials }}
        {{ $scratch.Set "appName" $app.Params.logo.name }}
        {{ $scratch.Set "logoSrc" $app.Params.logo.src }}
    {{ else if $app.Params.app }}
        {{ $scratch.Set "logoInitials" $app.Params.app.initials }}
        {{ $scratch.Set "appName" $app.Params.app.name }}
        {{ $scratch.Set "logoSrc" $app.Params.app.logo.src }}
    {{ end }}
    {{ if $app.Params.slug }}
        {{ with (index .Site.Data.apps_overview.apps $app.Params.slug) }}
            {{ if not ($scratch.Get "logoInitials") }}{{ $scratch.Set "logoInitials" .logo.initials }}{{ end }}
            {{ if not ($scratch.Get "appName") }}{{ $scratch.Set "appName" .logo.name }}{{ end }}
            {{ if not ($scratch.Get "logoSrc") }}{{ $scratch.Set "logoSrc" .logo.src }}{{ end }}
        {{ end }}
    {{ end }}
{{ end }}
{{ $logoInitials := $scratch.Get "logoInitials" }}
{{ $appName := $scratch.Get "appName" }}
{{ $logoSrc := $scratch.Get "logoSrc" }}

<header id="header" class="fixed w-full bg-white/80 backdrop-blur-sm shadow-md z-50 transition-all duration-300">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-3 flex justify-between items-center">
        <div class="flex items-center">
            <div class="bg-primary w-10 h-10 rounded-lg flex items-center justify-center">
                {{ if $isHome }}
                    <span class="text-white font-bold text-xl"><i class="fas fa-layer-group"></i></span>
                {{ else if $logoSrc }}
                    <img src="{{ $logoSrc }}" alt="{{ $appName }}" class="w-10 h-10 object-cover rounded-lg">
                {{ else if $logoInitials }}
                    <span class="text-white font-bold text-xl">{{ $logoInitials }}</span>
                {{ end }}
            </div>
            {{ if $isHome }}
                <span class="ml-3 font-bold text-xl text-dark">App Suite</span>
            {{ else if $appName }}
                <a href="{{ (printf "/apps/%s/" $app.Params.slug) | relURL }}"><span class="ml-3 font-bold text-xl text-dark">{{ $appName }}</span></a>
            {{ end }}
        </div>
        
        {{ if and (not $isHome) $nav }}
        <nav class="hidden md:flex space-x-8">
            {{ range $nav.links }}
                <a href="{{ .url | relURL }}" class="nav-link-desktop font-medium text-gray-600 hover:text-primary">{{ .name }}</a>
            {{ end }}
        </nav>
        {{ end }}
        
        {{ if $isHome }}
            <a href="#apps" class="hidden md:inline-block bg-primary hover:bg-secondary text-white px-6 py-2 rounded-full font-medium transition-colors duration-300 shadow-md">View All Apps</a>
        {{ else if $nav.button }}
            <a href="{{ $nav.button.url }}" class="hidden md:inline-block bg-primary hover:bg-secondary text-white px-6 py-2 rounded-full font-medium transition-colors duration-300 shadow-md">{{ $nav.button.text }}</a>
        {{ end }}
        
        <button id="mobile-menu-button" class="md:hidden text-gray-600 z-50 hamburger-icon">
             <div class="space-y-2">
                <span class="block w-6 h-0.5 bg-gray-600 line line1"></span>
                <span class="block w-6 h-0.5 bg-gray-600 line line2"></span>
                <span class="block w-6 h-0.5 bg-gray-600 line line3"></span>
            </div>
        </button>
    </div>
    
    {{ if and (not $isHome) $nav }}
    <div id="mobile-menu" class="hidden fixed inset-0 bg-white/95 backdrop-blur-lg md:hidden">
        <div class="flex flex-col items-center justify-center h-full space-y-8">
            {{ range $nav.links }}
                <a href="{{ .url | relURL }}" class="text-2xl font-medium text-gray-700 hover:text-primary">{{ .name }}</a>
            {{ end }}
            {{ with $nav.button }}
            <a href="{{ .url }}" class="mt-6 bg-primary text-white px-8 py-3 rounded-full text-lg font-medium">Download Now</a>
            {{ end }}
        </div>
    </div>
    {{ end }}
</header>
